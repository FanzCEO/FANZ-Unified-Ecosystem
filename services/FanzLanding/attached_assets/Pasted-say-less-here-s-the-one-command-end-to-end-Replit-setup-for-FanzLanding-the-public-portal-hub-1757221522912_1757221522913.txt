say less â€” hereâ€™s the one-command, end-to-end Replit setup for FanzLanding â€” the public portal + hub where people first meet FUN, learn the platforms/services, and sign up (SSO), with trust & safety, status, legal, SEO, referrals, newsletter, and diagnostics. It ships with self-verification so there are no missing pages, dead links, or API/UI gaps before you go live.

â¸»

ğŸ”§ One command to wire everything

Run this in the Replit shell at the repo root:

npm run prep:prod:fanzlanding

That single command builds FE+BE, migrates + seeds, generates OpenAPI + typed client, checks APIâ†”UI parity, validates schema drift, runs unit + E2E tests, crawls every page for 404s, optional a11y checks, and prints a neon READY FOR PROD banner if all green.

â¸»

1) Root package.json (scripts) â€” add/merge

{
  "name": "fanzlanding-monorepo",
  "private": true,
  "workspaces": ["app/frontend", "app/backend", "packages/*", "scripts"],
  "scripts": {
    "postinstall": "npm run -w app/frontend install && npm run -w app/backend install",
    "build": "npm run -w app/backend build && npm run -w app/frontend build",
    "migrate": "npm run -w app/backend migrate",
    "seed": "npm run -w app/backend seed",
    "test": "npm -w app/backend run test && npm -w app/frontend run test",
    "openapi": "npm -w app/backend run openapi && npm -w app/frontend run types:pull",
    "verify:contracts": "npm -w app/backend run verify:contracts",
    "verify:drift": "npm -w app/backend run verify:drift",
    "verify:webhooks": "npm -w app/backend run verify:webhooks",
    "verify:health": "npm -w app/backend run verify:health",
    "verify:a11y": "npm -w app/frontend run a11y || echo \"(a11y optional)\"",
    "e2e": "npm -w app/backend run e2e",
    "crawl": "npm -w app/frontend run crawl",
    "verify:all": "npm run build && npm run migrate && npm run seed && npm run test && npm run openapi && npm run verify:contracts && npm run verify:drift && npm run verify:webhooks && npm run verify:health && npm run e2e && npm run crawl && npm run verify:a11y",
    "prep:prod:fanzlanding": "node scripts/env-gate.cjs && npm run verify:all && node scripts/print-ready.cjs"
  },
  "devDependencies": { "concurrently": "^9.0.0" }
}


â¸»

2) Backend scripts (app/backend/package.json)

{
  "name": "fanzlanding-backend",
  "type": "module",
  "scripts": {
    "dev": "tsx src/index.ts",
    "build": "tsc -p tsconfig.json",
    "start": "node dist/index.js",
    "migrate": "drizzle-kit migrate",
    "studio": "drizzle-kit studio",
    "seed": "tsx scripts/seed.ts",
    "test": "vitest run",
    "openapi": "tsx scripts/generate-openapi.ts > public/docs/openapi.json",
    "verify:contracts": "tsx scripts/verify-contracts.ts",
    "verify:drift": "tsx scripts/verify-drift.ts",
    "verify:webhooks": "tsx scripts/verify-webhooks.ts",
    "verify:health": "tsx scripts/verify-health.ts",
    "e2e": "playwright test"
  }
}

Backend helper stubs you must include
	â€¢	scripts/generate-openapi.ts â€” emit OpenAPI from shared Zod schemas.
	â€¢	scripts/verify-contracts.ts â€” scan Express routes vs OpenAPI; ensure every endpoint has a handler + a typed client usage (or @serverOnly).
	â€¢	scripts/verify-drift.ts â€” drizzle introspect dry-run vs migrations.
	â€¢	scripts/verify-webhooks.ts â€” verify HMAC/signatures & handler presence for:
	â€¢	/webhooks/newsletter (ESP subscribe)
	â€¢	/webhooks/status (uptime/incidents)
	â€¢	/webhooks/verifymy (if signup flows kick KYC pre-checks)
	â€¢	scripts/verify-health.ts â€” DB ping, S3 asset check (optional), JWT sign/verify, sitemap/robots existence.
	â€¢	scripts/seed.ts â€” seed home sections, platform catalog, sample blog post, legal docs (ToS/Privacy), status sample, 2 referral codes, 1 newsletter list.

â¸»

3) Frontend scripts (app/frontend/package.json)

{
  "name": "fanzlanding-frontend",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build && node scripts/routes-manifest.cjs",
    "preview": "vite preview",
    "test": "vitest run",
    "routes:manifest": "node scripts/routes-manifest.cjs",
    "crawl": "node scripts/crawlLinks.cjs",
    "types:pull": "node scripts/pull-openapi-client.cjs",
    "a11y": "node scripts/a11y-check.cjs"
  }
}

Frontend helper stubs
	â€¢	scripts/routes-manifest.cjs â€” emit dist/routeManifest.json with {path, component, requiresAuth}, import each route once to catch broken imports.
	â€¢	scripts/crawlLinks.cjs â€” start preview, crawl from /, headless-visit links with Playwright, assert 200/OK + no console errors, write dist/link-report.json.
	â€¢	scripts/pull-openapi-client.cjs â€” regen a typed client from /docs/openapi.json.
	â€¢	scripts/a11y-check.cjs â€” run @axe-core/playwright against key routes; write dist/a11y-report.json (non-blocking by default).

â¸»

4) ENV gate + READY banner (root /scripts)

Create /scripts/env-gate.cjs:

const required = [
  'DATABASE_URL',
  'JWT_ISS','JWT_AUD','JWT_SECRET','JWT_ACCESS_TTL','JWT_REFRESH_TTL',
  'WEB_APP_URL','API_URL','PUBLIC_DOMAIN','NODE_ENV',
  // optional but recommended
  'ESP_PROVIDER','ESP_API_KEY',         // newsletter/ESP
  'STATUS_PROVIDER','STATUS_WEBHOOK_SECRET', // status/incidents
  'SSO_ISSUER','SSO_JWKS_URL'           // sign-in to FUN SSO
];
const missing = required.filter(k => !process.env[k]);
if (missing.length) {
  console.error('âŒ Missing required env vars:\n' + missing.map(k => ` - ${k}`).join('\n'));
  process.exit(1);
}
console.log('âœ… ENV check passed');

Create /scripts/print-ready.cjs:

console.log(`
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â•â•šâ•â•  â•šâ•â•â•â• â•šâ•â•â•â•â•â• 
FanzLanding: ALL CHECKS PASSED â€” READY FOR PROD âœ¨
`);


â¸»

5) Required ENV (Replit â†’ Tools â†’ Secrets)

# Core
DATABASE_URL=postgres://...
PUBLIC_DOMAIN=fanz.fun                 # public domain for canonical URLs
WEB_APP_URL=http://localhost:3000
API_URL=http://localhost:5173/api
NODE_ENV=production

# Auth for lightweight sessions (and SSO handoff)
JWT_ISS=fun.app
JWT_AUD=fun.public
JWT_SECRET=use-a-64-byte-random-string
JWT_ACCESS_TTL=900
JWT_REFRESH_TTL=2592000

# ESP / Newsletter (optional but recommended)
ESP_PROVIDER=postmark                 # or mailgun/sendgrid/mock
ESP_API_KEY=...

# Status / Incident intake (optional)
STATUS_PROVIDER=mock                  # mock | betterstack | instatus | custom
STATUS_WEBHOOK_SECRET=change-me

# SSO handoff (link to FUN SSO)
SSO_ISSUER=https://sso.fun
SSO_JWKS_URL=https://sso.fun/.well-known/jwks.json

# Analytics (privacy-friendly; optional)
PLAUSIBLE_DOMAIN=fanz.fun
PLAUSIBLE_API=...


â¸»

6) Route map (must exist & render)

Frontend (React 18 + TS + Vite + Tailwind + Radix/shadcn + TanStack Query + Wouter)
	â€¢	/ (Hero; â€œWho we areâ€ + trust badges + fast CTAs)
	â€¢	/platforms (BoyFanz, GirlFanz, PupFanz, FanzCommerce, FanzFiliate, FanzBook, FanzRadio/Pod, FanzDashâ€¦)
	â€¢	/services (compliance, payouts, creator tools, ad suite)
	â€¢	/security (Trust & Safety, 2257/VerifyMy overview, privacy)
	â€¢	/pricing (default: creators keep 100%; fee engine explainer)
	â€¢	/signup (SSO handoff â†’ create Fanz ID)
	â€¢	/signin (SSO handoff)
	â€¢	/ref/:code (referral deep-link â†’ stores cookie â†’ flows to signup)
	â€¢	/status (status summary, incidents feed)
	â€¢	/blog /blog/:slug
	â€¢	/legal/tos /legal/privacy /legal/acceptable-use /legal/2257
	â€¢	/contact (lead form, support, press)
	â€¢	/careers (basic)
	â€¢	/accessibility
	â€¢	/system (diagnostics)
	â€¢	/* 404

API (Express + TS + Zod)
	â€¢	/api/landing/sections (home CMS blocks)
	â€¢	/api/platforms (catalog + deep-links + icons)
	â€¢	/api/blog/* (posts, categories, rss)
	â€¢	/api/leads (contact form, partner inquiry)
	â€¢	/api/newsletter/subscribe
	â€¢	/api/referrals/* (generate, validate, stats)
	â€¢	/api/status/* (current, incidents)
	â€¢	/api/ab/* (feature flags + experiments for landing tests)
	â€¢	/api/sso/handoff (issue short-lived token and redirect URL to SSO)
	â€¢	/webhooks/newsletter (ESP), /webhooks/status (status provider), /webhooks/verifymy (optional pre-KYC probe)
	â€¢	/docs + /docs/openapi.json
	â€¢	/healthz /version /introspect/*
	â€¢	/sitemap.xml /robots.txt /humans.txt (static from backend or FE public)

â¸»

7) Data model (Drizzle + migrations + seeds)
	â€¢	cms_sections (key, content_json, published)
	â€¢	platforms (slug, name, tagline, icon_url, deep_link_url, category, order_index, status)
	â€¢	blog_posts (slug, title, mdx_s3_key or html, author, published_at, tags)
	â€¢	leads (name, email, type creator/partner/press, message, source, utm_json, status)
	â€¢	newsletter_subs (email, consent_ts, source, ref_code nullable)
	â€¢	referral_codes (code, owner_user_id nullable, campaign, clicks, signups)
	â€¢	status_incidents (provider, ext_id, title, status, impact, started_at, resolved_at, updates_json)
	â€¢	ab_experiments (key, variants_json, active, traffic_alloc)
	â€¢	feature_flags (key, value_json, active)
	â€¢	audit_logs (actor nullable, action, target_type, target_id, diff_json, created_at)
	â€¢	webhooks, api_keys

Seeds
	â€¢	Home hero + sections, 8 platform tiles, 1 blog post, 2 flags, 1 experiment (/signup variant B), 1 incident resolved, 2 referral codes, 1 newsletter list.

â¸»

8) SEO, privacy, a11y â€” built-ins
	â€¢	SEO: dynamic <head> per route (OG/Twitter cards), canonical URLs from PUBLIC_DOMAIN, sitemap.xml and robots.txt generated.
	â€¢	Privacy: no invasive tracking; optional Plausible; consent banner with CMP stub (non-blocking).
	â€¢	Accessibility: semantic landmarks, focus rings, aria-labels; axe checks in a11y-check.cjs (non-blocking but reported).
	â€¢	Performance: image lazy-loading, prefetch critical routes, cache headers for static.

â¸»

9) Diagnostics & completeness (auto)
	â€¢	Route Manifest: FE emits routeManifest.json; /system displays UI routes vs server routes vs OpenAPI endpoint count.
	â€¢	Link Crawler: visits all links from / â†’ link-report.json (0 failures required).
	â€¢	APIâ†”UI Parity: every documented endpoint has a server handler + typed client usage (or @serverOnly).
	â€¢	Schema Drift: drizzle introspect vs migrations; fail on drift.
	â€¢	Webhooks: HMAC tests for newsletter + status (and verifymy if enabled).
	â€¢	Health: DB/JWT checks, sitemap/robots availability, RSS/blog feed present.
	â€¢	A11y (optional): axe scan summary at /system (warning-only unless you flip a flag).

â¸»

10) Tests (must pass for READY banner)

Unit (Vitest)
	â€¢	referral code encode/decode + cookie persistence
	â€¢	newsletter subscribe validation + ESP webhook verify
	â€¢	status incident upsert from webhook
	â€¢	SSO handoff token mint + redirect URL build
	â€¢	sitemap and robots generation

E2E (Playwright)
	1.	Visitor lands / â†’ navigates Platforms â†’ deep-links work â†’ back to hub.
	2.	Referral link /ref/:code â†’ cookie set â†’ Signup SSO handoff triggered.
	3.	Newsletter subscribe â†’ webhook simulator posts confirm â†’ subscriber visible.
	4.	Status page renders last incident; blog page loads; legal pages accessible.
	5.	/system shows checks âœ…; link-report.json zero failures; a11y scan report present.

â¸»

11) Minimal /system JSON (backend)

Return something like:

{
  "db":"ok","jwt":"ok",
  "openapiEndpoints": 0, "serverRoutes": 0, "uiRoutes": 0,
  "sitemap":"ok","robots":"ok","rss":"ok",
  "webhookTests":{"newsletter":"ok","status":"ok","verifymy":"skip"},
  "a11y":{"checked": true, "violations": 0},
  "lastCrawl":{"urls": 0, "failures": 0}
}

(Replace zeros/counts at runtime.)

â¸»

12) Tech stack (Replit-friendly)
	â€¢	Frontend: React 18 + TS + Vite, Tailwind, Radix/shadcn, TanStack Query, Wouter
	â€¢	Backend: Node/Express + TS, Zod, Drizzle ORM + drizzle-kit
	â€¢	Docs: Zod â†’ OpenAPI at /docs
	â€¢	Tests: Vitest + Playwright (+ axe for a11y)

â¸»

13) Seed credentials (admin portal for content ops, optional)
	â€¢	LandingOps: ops@fanzlanding.app / Ops!234 (only to access /system and manage CMS blocks via a small gated UI).

â¸»

Run it
	1.	Add these scripts/files.
	2.	Set Secrets (ENV).
	3.	In Replit shell:

npm run prep:prod:fanzlanding

If everythingâ€™s wired, youâ€™ll get the neon READY FOR PROD crown. Welcome to the front door of FUN â€” fast, secure, and unapologetically creator-first. ğŸŸ¡ğŸŒ